address = street_address, full_results = TRUE)
library(tidyverse)
library(janitor)
library(lubridate)
#install.packages('tidygeocoder')
library(tidygeocoder)
install.packages("curl")
library(curl)
View(reverse)
View(month_total)
moco_data <-  read.csv("data/moco_data.csv")
View(moco_data)
moco_data %>%
separate(Start_Date_Time, c('start_date', 'start_time'), sep=' ', extra='merge')
moco_data %>%
separate(Start_Date_Time, c('start_date', 'start_time'), sep=' ', extra='merge') %>%
mutate(date = as.Date(date, format = "%m/%d/%Y"),
year = year(date),
month = month(date))
moco_data %>%
separate(Start_Date_Time, c('start_date', 'start_time'), sep=' ', extra='merge') %>%
mutate(date = as.Date(date, format = "%m/%d/%Y"),
year = year(start_date),
month = month(start_date))
moco_data %>%
separate(Start_Date_Time, c('start_date', 'start_time'), sep=' ', extra='merge') %>%
mutate(start_date = as.Date(start_date, format = "%m/%d/%Y"),
year = year(start_date),
month = month(start_date))
moco_data <- moco_data %>%
separate(Start_Date_Time, c('start_date', 'start_time'), sep=' ', extra='merge') %>%
mutate(start_date = as.Date(start_date, format = "%m/%d/%Y"),
year = year(start_date),
month = month(start_date))
moco_data <- moco_data %>%
separate(Start_Date_Time, c('start_date', 'start_time'), sep=' ', extra='merge') %>%
mutate(start_date = as.Date(start_date, format = "%m/%d/%Y"),
year = year(start_date),
month = month(start_date)) %>%
filter(year >= 2020)
rm(list = "moco_data")
moco_data <-  read.csv("data/moco_data.csv")
moco_data %>%
separate(Start_Date_Time, c('start_date', 'start_time'), sep=' ', extra='merge') %>%
mutate(start_date = as.Date(start_date, format = "%m/%d/%Y"),
year = year(start_date),
month = month(start_date)) %>%
filter(year >= 2020)
View(moco_data)
moco_data %>%
distinct(state)
moco_data %>%
distinct(State)
moco_data %>%
group_by(State) %>%
summarize(count = n())
moco_data %>%
filter(State == "17", State == "16", State == "0")
moco_data %>%
filter(State == "17"| State == "16" | State == "0")
moco_data %>%
group_by(State) %>%
summarize(count = n())
moco_data %>%
filter(State == "17"| State == "16" | State == "0")
moco_data %>%
group_by(State) %>%
summarize(count = n())
moco_data <- moco_data %>%
separate(Start_Date_Time, c('start_date', 'start_time'), sep=' ', extra='merge') %>%
mutate(start_date = as.Date(start_date, format = "%m/%d/%Y"),
year = year(start_date),
month = month(start_date)) %>%
filter(year >= 2020) %>%
select(-Incident.ID, -Offence.Code, -CR.Number, -Dispatch.Date...Time, -End_Date_Time, -Crime.Name1, -Crime.Name3, )
rm(list="moco_data")
moco_data <- moco_data %>%
clean_names() %>%
separate(Start_Date_Time, c('start_date', 'start_time'), sep=' ', extra='merge') %>%
mutate(start_date = as.Date(start_date, format = "%m/%d/%Y"),
year = year(start_date),
month = month(start_date)) %>%
filter(year >= 2020) %>%
select(-Incident.ID, -Offence.Code, -CR.Number, -Dispatch.Date...Time, -End_Date_Time, -Crime.Name1, -Crime.Name3, )
moco_data <-  read.csv("data/moco_data.csv")
moco_data %>%
distinct(city)
moco_data %>%
distinct(City)
moco_data <- moco_data %>%
clean_names() %>%
separate(Start_Date_Time, c('start_date', 'start_time'), sep=' ', extra='merge') %>%
mutate(start_date = as.Date(start_date, format = "%m/%d/%Y"),
year = year(start_date),
month = month(start_date)) %>%
filter(year >= 2020) %>%
select(-Incident.ID, -Offence.Code, -CR.Number, -Dispatch.Date...Time, -End_Date_Time, -Crime.Name1, -Crime.Name3, )
View(moco_data)
moco_data <- moco_data %>%
clean_names() %>%
separate(start_date_time, c('start_date', 'start_time'), sep=' ', extra='merge') %>%
mutate(start_date = as.Date(start_date, format = "%m/%d/%Y"),
year = year(start_date),
month = month(start_date)) %>%
filter(year >= 2020) %>%
select(-Incident.ID, -Offence.Code, -CR.Number, -Dispatch.Date...Time, -End_Date_Time, -Crime.Name1, -Crime.Name3, )
moco_data <- moco_data %>%
separate(Start_Date_Time, c('start_date', 'start_time'), sep=' ', extra='merge') %>%
mutate(start_date = as.Date(start_date, format = "%m/%d/%Y"),
year = year(start_date),
month = month(start_date)) %>%
filter(year >= 2020) %>%
select(-Incident.ID, -Offence.Code, -CR.Number, -Dispatch.Date...Time, -End_Date_Time, -Crime.Name1, -Crime.Name3,) %>%
clean_names()
moco_data %>%
distinct(city)
moco_data %>%
group_by(city) %>%
summarize(count = n())
moco_data %>%
group_by(city) %>%
summarize(count = n()) %>%
arrange(desc(city))
moco_data %>%
group_by(city) %>%
summarize(count = n()) %>%
arrange(city))
moco_data %>%
group_by(city) %>%
summarize(count = n()) %>%
arrange(city)
moco_data %>%
group_by(city) %>%
summarize(count = n())
a
moco_data <- moco_data %>%
mutate(city = case_when(
city = "SILVE SPRING" ~ "SILVER SPRING",
city = "BEHTESDA" ~ "BETHESDA",
city = "SILVERS SPRING" ~ "SILVER SPRING",
city = "GAIHTERSBURG" ~ "GAITHERSBUG",
city = "BETHEDA" ~ "BETHESDA",
city = "BARNSVILLE" ~ "BARNESVILLE",
city = "BEALSVILLE" ~ "BEALLSVILLE",
city = "CLAEKSBURG" ~ "CLARKSBURG",
city = "GAIHTERSBURG" ~ "GAITHERSBURG",
city = "GAITHERBURG" ~ "GAITHERSBURG",
city = "GAITHERSBUG" ~ "GAITHERSBURG",
city = "GAUTHERSBURG" ~ "GAITHERSBURG",
city = "GRMANTOWN" ~ "GERMANTOWN",
city = "KENSTINGTON" ~ "KENSINGTON",
city = "MT AIRY" ~ "MOUNT AIRY",
city = "TACOMA PARK" ~ "TAKOMA PARK",
city = "WEHATON" ~ "WHEATON",
TRUE ~ city
))
moco_data <- moco_data %>%
mutate(city = case_when(
city == "SILVE SPRING" ~ "SILVER SPRING",
city == "BEHTESDA" ~ "BETHESDA",
city == "SILVERS SPRING" ~ "SILVER SPRING",
city == "GAIHTERSBURG" ~ "GAITHERSBUG",
city == "BETHEDA" ~ "BETHESDA",
city == "BARNSVILLE" ~ "BARNESVILLE",
city == "BEALSVILLE" ~ "BEALLSVILLE",
city == "CLAEKSBURG" ~ "CLARKSBURG",
city == "GAIHTERSBURG" ~ "GAITHERSBURG",
city == "GAITHERBURG" ~ "GAITHERSBURG",
city == "GAITHERSBUG" ~ "GAITHERSBURG",
city == "GAUTHERSBURG" ~ "GAITHERSBURG",
city == "GRMANTOWN" ~ "GERMANTOWN",
city == "KENSTINGTON" ~ "KENSINGTON",
city == "MT AIRY" ~ "MOUNT AIRY",
city == "TACOMA PARK" ~ "TAKOMA PARK",
city == "WEHATON" ~ "WHEATON",
TRUE ~ city
))
moco_data %>%
group_by(city) %>%
summarize(count = n())
moco_data <- moco_data %>%
mutate(city = case_when(
city == "SILVE SPRING" ~ "SILVER SPRING",
city == "BEHTESDA" ~ "BETHESDA",
city == "SILVERS SPRING" ~ "SILVER SPRING",
city == "GAIHTERSBURG" ~ "GAITHERSBUG",
city == "BETHEDA" ~ "BETHESDA",
city == "BARNSVILLE" ~ "BARNESVILLE",
city == "BEALSVILLE" ~ "BEALLSVILLE",
city == "CLAEKSBURG" ~ "CLARKSBURG",
city == "GAIHTERSBURG" ~ "GAITHERSBURG",
city == "GAITHERBURG" ~ "GAITHERSBURG",
city == "GAITHERSBUG" ~ "GAITHERSBURG",
city == "GAUTHERSBURG" ~ "GAITHERSBURG",
city == "GAITHERSBUG" ~ "GAITHERSBURG",
city == "GRMANTOWN" ~ "GERMANTOWN",
city == "KENSTINGTON" ~ "KENSINGTON",
city == "MT AIRY" ~ "MOUNT AIRY",
city == "TACOMA PARK" ~ "TAKOMA PARK",
city == "WEHATON" ~ "WHEATON",
TRUE ~ city
))
moco_data %>%
group_by(city) %>%
summarize(count = n())
moco_data %>%
filter(year == "2023")
moco_data %>%
group_by(crime_name2)
moco_data %>%
group_by(crime_name2) %>%
summarize(count = n())
# cleaning
moco_data <- moco_data %>%
separate(Start_Date_Time, c('start_date', 'start_time'), sep=' ', extra='merge') %>%
mutate(start_date = as.Date(start_date, format = "%m/%d/%Y"),
year = year(start_date),
month = month(start_date)) %>%
filter(year >= 2020) %>%
select(-Incident.ID, -Offence.Code, -CR.Number, -Dispatch.Date...Time, -End_Date_Time, -Crime.Name1, -Crime.Name3,) %>%
rename(Crime.Name2 = crime_name)
rm(list="moco_data")
moco_data <-  read.csv("data/moco_data.csv")
moco_data <- moco_data %>%
separate(Start_Date_Time, c('start_date', 'start_time'), sep=' ', extra='merge') %>%
mutate(start_date = as.Date(start_date, format = "%m/%d/%Y"),
year = year(start_date),
month = month(start_date)) %>%
filter(year >= 2020) %>%
select(-Incident.ID, -Offence.Code, -CR.Number, -Dispatch.Date...Time, -End_Date_Time, -Crime.Name1, -Crime.Name3,) %>%
rename(Crime.Name2 = crime_name) %>%
clean_names()
moco_data <- moco_data %>%
separate(Start_Date_Time, c('start_date', 'start_time'), sep=' ', extra='merge') %>%
mutate(start_date = as.Date(start_date, format = "%m/%d/%Y"),
year = year(start_date),
month = month(start_date)) %>%
filter(year >= 2020) %>%
select(-Incident.ID, -Offence.Code, -CR.Number, -Dispatch.Date...Time, -End_Date_Time, -Crime.Name1, -Crime.Name3,) %>%
rename(crime_name = Crime.Name2) %>%
clean_names()
moco_data %>%
group_by(city) %>%
summarize(count = n())
moco_data <- moco_data %>%
mutate(city = case_when(
city == "SILVE SPRING" ~ "SILVER SPRING",
city == "BEHTESDA" ~ "BETHESDA",
city == "SILVERS SPRING" ~ "SILVER SPRING",
city == "GAIHTERSBURG" ~ "GAITHERSBUG",
city == "BETHEDA" ~ "BETHESDA",
city == "BARNSVILLE" ~ "BARNESVILLE",
city == "BEALSVILLE" ~ "BEALLSVILLE",
city == "CLAEKSBURG" ~ "CLARKSBURG",
city == "GAIHTERSBURG" ~ "GAITHERSBURG",
city == "GAITHERBURG" ~ "GAITHERSBURG",
city == "GAITHERSBUG" ~ "GAITHERSBURG",
city == "GAUTHERSBURG" ~ "GAITHERSBURG",
city == "GAITHERSBUG" ~ "GAITHERSBURG",
city == "GRMANTOWN" ~ "GERMANTOWN",
city == "KENSTINGTON" ~ "KENSINGTON",
city == "MT AIRY" ~ "MOUNT AIRY",
city == "TACOMA PARK" ~ "TAKOMA PARK",
city == "WEHATON" ~ "WHEATON",
TRUE ~ city
))
moco_data %>%
group_by(crime_name2) %>%
summarize(count = n())
moco_data %>%
group_by(crime_name) %>%
summarize(count = n())
moco_data %>%
distinct(crime_name)
moco_data %>%
filter(year == "2023", crime_name == "Motor Vehicle Theft")
moco_2023 <- moco_data %>%
filter(year == "2023", crime_name == "Motor Vehicle Theft")
moco_car_thefts <- moco_data %>%
filter(crime_name == "Motor Vehicle Theft")
View(moco_car_thefts)
moco_car_thefts %>%
group_by(year) %>%
summarize(count = n())
moco_yearly <- moco_car_thefts %>%
group_by(year) %>%
summarize(count = n())
ggplot() +
geom_bar(
data=moco_yearly,
aes(x=year, weight=`count`))
moco_car_thefts %>%
group_by(year) %>%
summarize(count = n()) %>%
mutate(perc = count/sum(count)*100))
moco_car_thefts %>%
group_by(year) %>%
summarize(count = n()) %>%
mutate(perc = count/sum(count)*100)
moco_car_thefts %>%
group_by(year) %>%
summarize(count = n()) %>%
mutate(perc = count/sum(count)*100)
moco_yearly <- moco_car_thefts %>%
group_by(year) %>%
summarize(count = n()) %>%
mutate(perc = count/sum(count)*100)
ggplot() +
geom_bar(
data=moco_yearly,
aes(x=year, weight=`count`))
moco_car_thefts %>%
group_by(year) %>%
summarize(count = n()) %>%
mutate(perc = count/sum(count)*100)
ggplot() +
geom_bar(
data=moco_yearly,
aes(x=year, weight=`count`))
moco_car_thefts %>%
group_by(place) %>%
summarize(count = n())
moco_car_thefts %>%
group_by(place) %>%
summarize(count = n()) %>%
arrange(desc(count))
moco_theft_places <- moco_car_thefts %>%
group_by(place) %>%
summarize(count = n()) %>%
mutate(perc = count/sum(count)*100) %>%
arrange(desc(count))
moco_car_thefts %>%
group_by(place) %>%
summarize(count = n()) %>%
mutate(perc = count/sum(count)*100) %>%
arrange(desc(count))
moco_car_thefts %>%
group_by(month, year) %>%
summarize(count = n()) %>%
mutate(month = month(month, label = TRUE)) %>%
arrange(desc(count))
moco_car_thefts %>%
group_by(month, year) %>%
summarize(count = n()) %>%
mutate(month = month(month, label = TRUE)) %>%
arrange(desc(count)) %>%
pivot_wider(names_from = year, values_from = count, values_fill = 0)
moco_car_thefts %>%
group_by(month, year) %>%
summarize(count = n()) %>%
mutate(month = month(month, label = TRUE)) %>%
pivot_wider(names_from = year, values_from = count, values_fill = 0)
moco_2023 %>%
group_by(month)
moco_2023 %>%
group_by(month) %>%
summarize(count = n())
moco_monthly <- moco_car_thefts %>%
group_by(month, year) %>%
summarize(count = n()) %>%
mutate(month = month(month, label = TRUE)) %>%
pivot_wider(names_from = year, values_from = count, values_fill = 0)
moco_car_thefts %>%
group_by(month, year) %>%
summarize(count = n()) %>%
mutate(month = month(month, label = TRUE)) %>%
pivot_wider(names_from = year, values_from = count, values_fill = 0)
ggplot(aes(x = month, y = `year`, color = factor(year))) +
geom_line() +
labs(
title = "Monthly Car Thefts Over the Years",
x = "Month",
y = "Count",
color = "Year")
moco_monthly <- moco_car_thefts %>%
group_by(month, year) %>%
summarize(count = n()) %>%
mutate(month = month(month, label = TRUE)) %>%
pivot_wider(names_from = year, values_from = count, values_fill = 0)
oco_car_thefts %>%
group_by(month, year) %>%
summarize(count = n()) %>%
mutate(month = month(month, label = TRUE)) %>%
pivot_wider(names_from = year, values_from = count, values_fill = 0)
moco_car_thefts %>%
group_by(month, year) %>%
summarize(count = n()) %>%
mutate(month = month(month, label = TRUE)) %>%
pivot_wider(names_from = year, values_from = count, values_fill = 0)
gplot(aes(x = month, y = `YEAR_1`, color = factor(year)) +
gplot(aes(x = month, y = `YEAR_1`, color = factor(year)) +
geom_line() +
labs(
title = "Car Thefts Over the Months",
x = "Month",
y = "Count",
color = "Year"
)
ggplot(aes(x = month, y = `YEAR_1`, color = factor(year)) +
geom_line() +
labs(
title = "Car Thefts Over the Months",
x = "Month",
y = "Count",
color = "Year"
)
ggplot(aes(x = month, y = year, color = factor(year))) +
geom_line() +
labs(
title = "Car Thefts Over the Months",
x = "Month",
y = "Count",
color = "Year"
)
View(moco_monthly)
ggplot(aes(data = moco_monthly, x = month, y = year, color = factor(year))) +
geom_line() +
labs(
title = "Car Thefts Over the Months",
x = "Month",
y = "Count",
color = "Year"
)
ggplot(data = moco_monthly, aes(x = month, y = year, color = factor(year))) +
geom_line() +
labs(
title = "Car Thefts Over the Months",
x = "Month",
y = "Count",
color = "Year"
)
moco_car_thefts %>%
group_by(year) %>%
summarize(count = n()) %>%
mutate(perc = count/sum(count)*100)
View(moco_yearly)
write_csv(moco_2023, "data/moco_2023.csv")
write_csv(moco_car_thefts, "data/moco_car_thefts.csv")
reverse_geocoding_stolen_auto <- stolen_auto %>%
reverse_geocode(lat = latitude, long = longitude, method = 'osm',
address = street_address, full_results = TRUE)
View(moco_data)
rm(list="moco_data")
moco_data <-  read.csv("data/moco_data.csv")
View(moco_data)
# cleaning
moco_data <- moco_data %>%
separate(Dispatch.Date...Time, c('start_date', 'start_time'), sep=' ', extra='merge') %>%
mutate(start_date = as.Date(start_date, format = "%m/%d/%Y"),
year = year(start_date),
month = month(start_date)) %>%
filter(year >= 2020) %>%
select(-Incident.ID, -Offence.Code, -CR.Number, -Start_Date_Time, -End_Date_Time, -Crime.Name1, -Crime.Name3,) %>%
rename(crime_name = Crime.Name2) %>%
clean_names()
moco_data %>%
group_by(city) %>%
summarize(count = n())
moco_data <- moco_data %>%
mutate(city = case_when(
city == "SILVE SPRING" ~ "SILVER SPRING",
city == "BEHTESDA" ~ "BETHESDA",
city == "SILVERS SPRING" ~ "SILVER SPRING",
city == "GAIHTERSBURG" ~ "GAITHERSBUG",
city == "BETHEDA" ~ "BETHESDA",
city == "BARNSVILLE" ~ "BARNESVILLE",
city == "BEALSVILLE" ~ "BEALLSVILLE",
city == "CLAEKSBURG" ~ "CLARKSBURG",
city == "GAIHTERSBURG" ~ "GAITHERSBURG",
city == "GAITHERBURG" ~ "GAITHERSBURG",
city == "GAITHERSBUG" ~ "GAITHERSBURG",
city == "GAUTHERSBURG" ~ "GAITHERSBURG",
city == "GAITHERSBUG" ~ "GAITHERSBURG",
city == "GRMANTOWN" ~ "GERMANTOWN",
city == "KENSTINGTON" ~ "KENSINGTON",
city == "MT AIRY" ~ "MOUNT AIRY",
city == "TACOMA PARK" ~ "TAKOMA PARK",
city == "WEHATON" ~ "WHEATON",
TRUE ~ city
))
moco_data %>%
distinct(crime_name)
moco_2023 <- moco_data %>%
filter(year == "2023", crime_name == "Motor Vehicle Theft")
#exporting 2023
write_csv(moco_2023, "data/moco_2023.csv")
moco_car_thefts <- moco_data %>%
filter(crime_name == "Motor Vehicle Theft")
write_csv(moco_car_thefts, "data/moco_car_thefts.csv")
View(moco_car_thefts)
moco_yearly <- moco_car_thefts %>%
group_by(year) %>%
summarize(count = n()) %>%
mutate(perc = count/sum(count)*100)
ggplot() +
geom_bar(
data=moco_yearly,
aes(x=year, weight=`count`))
moco_theft_places <- moco_car_thefts %>%
group_by(place) %>%
summarize(count = n()) %>%
mutate(perc = count/sum(count)*100) %>%
arrange(desc(count))
moco_monthly <- moco_car_thefts %>%
group_by(month, year) %>%
summarize(count = n()) %>%
mutate(month = month(month, label = TRUE)) %>%
pivot_wider(names_from = year, values_from = count, values_fill = 0)
moco_car_thefts %>%
group_by(year) %>%
summarize(count = n()) %>%
mutate(perc = count/sum(count)*100)
