---
name: Dylan Manfre and Natalie Davis
title: "R Notebook"
output: html_notebook
---

Notes
- Link to the data I downloaded from PG Open Data https://data.princegeorgescountymd.gov/Public-Safety/Crime-Incidents-February-2017-to-5th-July-2023/wb4e-w4nf

library
```{r}
library(tidyverse)
library(janitor)
library(lubridate)
```

loading data
```{r}
pg_county_crime <-  read.csv("data/pg_county_crime.csv")
```

______

cleaning data
```{r}
pg_county_crime <- pg_county_crime %>% 
  clean_names()
```
making the dates appropreate
```{r}

#extracting the year column and making the date the correct format
pg_county_crime <- pg_county_crime %>%
  mutate(date = as.Date(date, format = "%m/%d/%Y"),
          year = year(date))

# Renaming the crime column to be easier to work with
pg_county_crime <-  pg_county_crime %>% 
  rename(crime_type = clearance_code_inc_type)

```

Showing distinct crimes: 22 types of crime here.
```{r}
pg_county_crime %>% 
  distinct(crime_type)
```


----- Exploratory data section -------
What I want to accomplish here?
- I want to see monthly data that goes back a few years for stolen, auto. 




filtering for AUTO, STOLEN
```{r}
stolen_auto <- pg_county_crime %>% 
  filter(crime_type == "AUTO, STOLEN")
```
Time elements
```{r}
# yearly data
yearly_data <- stolen_auto %>%
  group_by(year) %>%
  summarize(count = n())

# showing a % growth
(3338 - 2331)/(2331)*100
```
Confirms a steady increase from 2021 on, after a slight decline from 2017-2020.

Showing on a graph to visualize the increase.
```{r}
ggplot() + 
  geom_bar(
    data=yearly_data, 
    aes(x=year, weight=`count`))
```
monthly totals
```{r}
month_total_2023 <- stolen_auto %>% 
  filter(year == "2023") %>% 
  mutate(month = month(date)) %>% 
  group_by(month, year) %>%
  summarize(count = n())

#Data only goes to July 5 which is why July is so low.
```

```{r}
month_total_2022 <- stolen_auto %>%
  filter(year == "2022") %>%
  mutate(month = month(date)) %>%
  group_by(month, year) %>%
  summarize(count = n())

month_total_2021 <- stolen_auto %>%
  filter(year == "2021") %>%
  mutate(month = month(date)) %>%
  group_by(month, year) %>%
  summarize(count = n())

month_total_2020 <- stolen_auto %>%
  filter(year == "2020") %>%
  mutate(month = month(date)) %>%
  group_by(month, year) %>%
  summarize(count = n())

month_total_2019 <- stolen_auto %>%
  filter(year == "2019") %>%
  mutate(month = month(date)) %>%
  group_by(month, year) %>%
  summarize(count = n())

month_total_2018 <- stolen_auto %>%
  filter(year == "2018") %>%
  mutate(month = month(date)) %>%
  group_by(month, year) %>%
  summarize(count = n())

month_total_2017 <- stolen_auto %>%
  filter(year == "2017") %>%
  mutate(month = month(date)) %>%
  group_by(month, year) %>%
  summarize(count = n())

# Bind the rows
month_totals <- bind_rows(
  month_total_2023,
  month_total_2022,
  month_total_2021,
  month_total_2020,
  month_total_2019,
  month_total_2018,
  month_total_2017
)

#putting month names
month_totals <- month_totals %>% 
  mutate(month = month(month, label = TRUE))

View(month_totals)
#Note the data only goes back to Feb. 2017
```

Which month/year had the most?.... Feb. 2023 had the most with 624 thefts. 
```{r}
month_totals %>% 
  arrange(desc(count))
```

